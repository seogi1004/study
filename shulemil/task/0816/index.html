<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>0816 과제</title>
</head>
<body>
    <div id="chart"></div>

    <script src="../xy_tpl/jquery.min.js"></script>
    <script src="../xy_tpl/jui.chart.min.js"></script>
    <script src="../xy_tpl/coordinate.js"></script>
    <script>

        jui.define("chart.brush.template", [ "util.base", "util.math" ], function() {
            var Template = function() {
                this.draw = function() {
                    var g = this.chart.svg.group();

                    this.eachData(function(i, data) {
                        g.append(this.chart.svg.circle({
                            fill: this.color(i),
                            r: this.brush.size,
                            cx: this.axis.x(data.x),
                            cy: this.axis.y(data.y)
                        }));
                    });

                    return g;
                }
            }

            Template.setup = function() {
                return {
                    size: 3
                }
            }

            return Template;
        }, "chart.brush.core");

        jui.ready(["chartx.coordinate"], function (builder) {
            var data = [], cnt = 36, degree = 360 / cnt, radian = 0, seq = 5;

            for (var i = 0; i < cnt; i = i + 1) {
                var xy = {};
                radian = degree * i * Math.PI / 180;
                xy.x = seq * Math.cos(radian);
                xy.y = seq * Math.sin(radian);
                data.push(xy);
            }

            window.c = builder("#chart", {
                domain: [-20, 20],
                brush: "template",
                data: data
            });


            setInterval(function() {
                var x = 0, y = 0, z = 0,
                    radin = 15/180*Math.PI,
                    cosa = Math.cos(radin), sina = Math.sin(radin),
                    data = c.options.data;
        
                r = [
                    // z축 회전
                    //[cosa, -sina, 0, 0],
                    //[sina, cosa, 0, 0],
                    //[0, 0, 1, 0],
                    //[0, 0, 0, 1]

                    // x축 회전
                    //[1, 0, 0, 0],
                    //[0, cosa, sina, 0],
                    //[0, -sina, cosa, 0],
                    //[0, 0, 0, 1]

                    // y축 회전
                    [cosa, 0, -sina, 0],
                    [0, 1, 0, 0],
                    [sina, 0, cosa, 0],
                    [0, 0, 0, 1]
                ]; 
                
                for (var i = 0, lenR = data.length; i < lenR; i++) {
                    x = data[i].x, y = data[i].y, z = data[i].z || 0;
                    data[i].x = (r[0][0] * x) + (r[0][1] * y) + (r[0][2] * z) + (r[0][3] * 1);
                    data[i].y = (r[1][0] * x) + (r[1][1] * y) + (r[1][2] * z) + (r[1][3] * 1);
                    data[i].z = (r[2][0] * x) + (r[2][1] * y) + (r[2][2] * z) + (r[2][3] * 1);
                }

                c.update(data);
            }, 200);

        });

    </script>
</body>
</html>